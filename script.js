const questions = [
    // --- 25 سؤال صح وغلط (تركيز على الفروض والمبادئ) ---
    { q: "المحاسبة المالية تخدم الإدارة فقط ولا تهم أطرافاً خارجية. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "مبدأ التكلفة التاريخية يقضي بتسجيل الأصول بسعر شرائها الأصلي. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "فرض الشخصية المعنوية يعني فصل أموال صاحب المنشأة عن أموال المنشأة. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "المعادلة المحاسبية هي الأصول + الخصوم = حقوق الملكية. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "الأراضي من الأصول الثابتة التي يتم حساب إهلاك سنوي لها. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "مبدأ الحيطة والحذر يعني تجاهل الخسائر المتوقعة. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "أساس الاستحقاق يسجل الإيرادات عند حدوثها حتى لو لم تُقبض نقداً. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "المسحوبات الشخصية تزيد من حقوق الملكية. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "ميزان المراجعة بالأرصدة هو كشف للتأكد من التوازن الحسابي. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "القرض طويل الأجل يعتبر من الأصول المتداولة. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "مردودات المشتريات طبيعتها مدينة. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "الخصم التجاري يظهر في الدفاتر المحاسبية. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "المدينون حساب يمثل مبالغ للمنشأة عند الغير. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "قائمة الدخل تهدف لقياس المركز المالي للمنشأة. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "مبدأ المقابلة يعني مقابلة إيرادات الفترة بمصروفاتها. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "المصروفات تجعل رأس المال ينقص. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "الإيرادات تجعل رأس المال يزيد. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "أوراق القبض التزام على المنشأة للغير. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "دفتر الأستاذ يتم فيه تبويب العمليات المحاسبية. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "مبدأ الإفصاح يعني كتمان المعلومات المالية الهامة. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "الدورة المحاسبية تبدأ بالعملية المالية وتنتهي بالقوائم المالية. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "المخزون السلعي يعتبر من الأصول المتداولة. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "حقوق الملكية هي الفرق بين الأصول والالتزامات. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },
    { q: "الزيادة في حساب البنك تجعله دائناً. (صح/غلط)", a: ["صح", "غلط"], c: "غلط" },
    { q: "المحاسبة كنظام تشمل مدخلات وتشغيل ومخرجات. (صح/غلط)", a: ["صح", "غلط"], c: "صح" },

    // --- 25 سؤال اختر من متعدد (قيود وتصنيفات) ---
    { q: "أي مما يلي يعتبر من الأصول الثابتة؟", a: ["البنك", "المدينون", "المباني", "أوراق القبض"], c: "المباني" },
    { q: "بدأ نشاطه بإيداع 50,000 ج في البنك، الطرف المدين هو:", a: ["ح/رأس المال", "ح/البنك", "ح/الخزينة"], c: "ح/البنك" },
    { q: "شراء سيارة نقداً يؤدي إلى:", a: ["زيادة أصل ونقص أصل", "زيادة أصل وزيادة التزام", "نقص أصل"], c: "زيادة أصل ونقص أصل" },
    { q: "الديون التي على المنشأة للموردين تسمى:", a: ["المدينون", "الدائنون", "المسحوبات"], c: "الدائنون" },
    { q: "أي من الحسابات التالية رصيده الطبيعي دائن؟", a: ["المشتريات", "المبيعات", "الأثاث", "الإيجار"], c: "المبيعات" },
    { q: "سحب صاحب المنشأة نقدية للاستخدام الشخصي يسمى:", a: ["مصروفات", "مسحوبات", "إيرادات"], c: "مسحوبات" },
    { q: "عند شراء بضاعة على الحساب، الطرف الدائن هو:", a: ["ح/المشتريات", "ح/الموردين", "ح/الخزينة"], c: "ح/الموردين" },
    { q: "مبدأ التسجيل المحاسبي بسعر الشراء الفعلي هو:", a: ["الثبات", "التكلفة التاريخية", "المقابلة"], c: "التكلفة التاريخية" },
    { q: "ترحيل القيود يتم من دفتر اليومية إلى:", a: ["الميزانية", "دفتر الأستاذ", "قائمة الدخل"], c: "دفتر الأستاذ" },
    { q: "أوراق الدفع تعتبر من:", a: ["الأصول", "الالتزامات", "حقوق الملكية"], c: "الالتزامات" },
    { q: "إذا كان (أصول = 100) و (خصوم = 40) فإن حقوق الملكية تساوي:", a: ["140", "60", "40"], c: "60" },
    { q: "قائمة الدخل تظهر:", a: ["الأصول والخصوم", "نتيجة النشاط ربح/خسارة", "التدفق النقدي"], c: "نتيجة النشاط ربح/خسارة" },
    { q: "سداد مصروف الرواتب بشيك، الطرف الدائن هو:", a: ["ح/الرواتب", "ح/البنك", "ح/الخزينة"], c: "ح/البنك" },
    { q: "الخصم المكتسب يمثل بالنسبة للمنشأة:", a: ["خسارة", "ربح (إيراد)", "أصل"], c: "ربح (إيراد)" },
    { q: "مردودات المبيعات طبيعتها:", a: ["مدينة", "دائنة", "حسب العملية"], c: "مدينة" },
    { q: "الديون التي للمنشأة عند العملاء تسمى:", a: ["مدينون", "دائنون", "قروض"], c: "مدينون" },
    { q: "أي مما يلي يعتبر مستفيداً خارجياً من المحاسبة؟", a: ["مدير الإنتاج", "المستثمرون", "المحاسب"], c: "المستثمرون" },
    { q: "المبدأ الذي يقضي بتوقع الخسائر وتجاهل الأرباح حتى تتحقق:", a: ["التحقق", "الحيطة والحذر", "الإفصاح"], c: "الحيطة والحذر" },
    { q: "الحساب الذي يمثل حق صاحب المنشأة تجاه أصولها هو:", a: ["الخصوم", "رأس المال", "الأصول"], c: "رأس المال" },
    { q: "في القيد المزدوج، الجانب 'إلى حـ/' هو الجانب:", a: ["المدين", "الدائن", "المتوازن"], c: "الدائن" },
    { q: "شراء بضاعة بخصم تجاري 10%، يسجل القيد بـ:", a: ["إجمالي السعر", "صافي السعر بعد الخصم", "قيمة الخصم فقط"], c: "صافي السعر بعد الخصم" },
    { q: "الكمبيالة التي تلتزم المنشأة بدفعها تسمى:", a: ["أوراق قبض", "أوراق دفع", "شيكات"], c: "أوراق دفع" },
    { q: "الحساب الذي يجعل حقوق الملكية تنقص هو:", a: ["المسحوبات", "الإيرادات", "القروض"], c: "المسحوبات" },
    { q: "أين تظهر بضاعة آخر المدة؟", a: ["قائمة الدخل فقط", "الميزانية فقط", "قائمة الدخل والميزانية"], c: "قائمة الدخل والميزانية" },
    { q: "المحاسبة التي تخدم مصلحة الضرائب هي المحاسبة:", a: ["الإدارية", "المالية", "الضريبية"], c: "الضريبية" },

    // --- 10 أسئلة مقالية مطورة (فهم عميق) ---
    { q: "ماذا يعني 'قيد اليومية' وما هي أركانه؟", a: ["تسجيل طرفين مدين ودائن", "كتابة التاريخ فقط", "جمع الأصول"], c: "تسجيل طرفين مدين ودائن" },
    { q: "ما هو أثر شراء آلة على الحساب على الميزانية؟", a: ["زيادة أصول وزيادة التزامات", "نقص أصول", "لا تتأثر"], c: "زيادة أصول وزيادة التزامات" },
    { q: "ما هو الفرق بين الخصم التجاري والخصم النقدي؟", a: ["التجاري لا يظهر بالدفاتر والنقدي يظهر", "كلاهما يظهر", "كلاهما لا يظهر"], c: "التجاري لا يظهر بالدفاتر والنقدي يظهر" },
    { q: "ما هي الأصول المتداولة (اذكر مثالاً)؟", a: ["أصول تتحول لنقدية سريعاً كالبنك", "أصول ثابتة كالأرض", "الديون"], c: "أصول تتحول لنقدية سريعاً كالبنك" },
    { q: "لماذا تظهر الميزانية في تاريخ محدد (لحظة زمنية)؟", a: ["لأنها تصور حالة المركز المالي في لحظة", "لأنها تقيس الربح", "بسبب البنك"], c: "لأنها تصور حالة المركز المالي في لحظة" },
    { q: "ما المقصود بأساس الاستحقاق؟", a: ["تسجيل ما يخص الفترة بغض النظر عن القبض/الدفع", "تسجيل الكاش فقط", "تجاهل المصروفات"], c: "تسجيل ما يخص الفترة بغض النظر عن القبض/الدفع" },
    { q: "ماذا يعني 'ميزان المراجعة بالمجاميع'؟", a: ["مجموع الجانب المدين والدائن لكل حساب", "الأرصدة النهائية فقط", "صافي الربح"], c: "مجموع الجانب المدين والدائن لكل حساب" },
    { q: "لماذا يعتبر رأس المال حساباً دائناً؟", a: ["لأنه يمثل التزام المنشأة للملاك", "لأنه ملك للمنشأة", "لأنه أصل"], c: "لأنه يمثل التزام المنشأة للملاك" },
    { q: "ما هو دور 'دفتر الأستاذ' في العملية المحاسبية؟", a: ["تبويب وتجميع أرصدة الحسابات", "تسجيل القيود لأول مرة", "كشف الضرائب"], c: "تبويب وتجميع أرصدة الحسابات" },
    { q: "ماذا يحدث عند تساوي إيرادات المنشأة مع مصروفاتها؟", a: ["تحقيق نقطة التعادل (لا ربح ولا خسارة)", "صافي ربح", "صافي خسارة"], c: "تحقيق نقطة التعادل (لا ربح ولا خسارة)" }
];

let currentIdx = 0;
let score = 0;
let shuffledQs = [];

const qEl = document.getElementById('question');
const optEl = document.getElementById('options');
const nextBtn = document.getElementById('next-btn');
const scoreEl = document.getElementById('score');
const countEl = document.getElementById('q-count');
const progress = document.getElementById('progress');

function startQuiz() {
    shuffledQs = [...questions].sort(() => Math.random() - 0.5);
    currentIdx = 0;
    score = 0;
    renderQuestion();
}

function renderQuestion() {
    optEl.innerHTML = '';
    nextBtn.classList.add('hide');
    let q = shuffledQs[currentIdx];
    qEl.innerText = q.q;
    countEl.innerText = currentIdx + 1;
    progress.style.width = `${((currentIdx + 1) / shuffledQs.length) * 100}%`;

    q.a.forEach(option => {
        const btn = document.createElement('button');
        btn.innerText = option;
        btn.classList.add('option');
        btn.onclick = () => {
            if (option === q.c) {
                btn.classList.add('correct');
                score++;
                scoreEl.innerText = score;
            } else {
                btn.classList.add('wrong');
                Array.from(optEl.children).forEach(b => {
                    if (b.innerText === q.c) b.classList.add('correct');
                });
            }
            Array.from(optEl.children).forEach(b => b.disabled = true);
            nextBtn.classList.remove('hide');
        };
        optEl.appendChild(btn);
    });
}

nextBtn.onclick = () => {
    currentIdx++;
    if (currentIdx < shuffledQs.length) {
        renderQuestion();
        window.scrollTo(0, 0);
    } else {
        qEl.innerText = `انتهى الاختبار! حصلت على ${score} من ${shuffledQs.length}`;
        optEl.innerHTML = `<button onclick="location.reload()" style="width:100%; padding:15px; background:var(--success); color:white; border:none; border-radius:12px; cursor:pointer;">إعادة المحاولة</button>`;
        nextBtn.classList.add('hide');
    }
};

document.addEventListener('DOMContentLoaded', startQuiz);